# 前提
	- 公司APP在微信开方平台  申请第三方授权的合作， 得到  **client id【客户端用】 ** **和**** client secret【服务器用】**
- # 分段流程
	- ## 1、客户端用client id去获取Authorization code
		- 1、用户通过《58》app，==**点击「微信登录」**==，
			- 58 app 将通过微信SDK ==**跳转到微信页面**==，
			- ==**传⼊之前申请的client id**==作为身份标识
		- 2、微信SDK[[#red]]==**通过client id**==从微信服务器
			- [[#red]]==**获取《58同城》APP信息**==比如：图标名字并显示在界⾯中
			- 并**[[#red]]==询问⽤户是否同意该 App 使⽤微信登录==**
		- 3、⽤户点击[[#green]]==**「使⽤微信登录」**==后，微信  向  微信服务器[[#green]]==**提交用户授权信息**==。微信服务器[[#green]]==**返回 Authorization code**==，同时跳转回《58》App
	- ## 2、58 app请求58 服务器微信登录api
		- 4、《58》调⽤⾃⼰服务器的「微信登录」 Api ，并传⼊ [[#red]]==**Authorization  code**== ，然后等待服务器响应
			- 【剩下的登录操作都交给自己服务器 与微信服务器交互了】
		- 5、58 服务器拿客户端发来的 Authorization code [[#red]]==**去向微信的第三 ⽅授权接⼝**==发送请求，[[#red]]==**将 Authorization code 和⾃⼰的 client secret ⼀起 作为参数发送**==，微信在验证通过后，[[#red]]==**返回 access token**==  【授权完成了OAuth2 在这里就结束了 】
	- ## 3、下边处理登录逻辑
		- 6、58服务器==**通过access token**== 去向微信的⽤户信息接⼝发送请求，==**获取⽤户信息**==
		- 7 、58服务器收到用户信息后
			- 从数据库为用户创建账户、保存用户微信信息、关联用户id和微信id
		- 8、⽤户创建完成后，58服务器向58客户端的之前登录请求发送响应，传送回刚创建好的⽤户信息
		- 9 客户端收到服务器响应，⽤户登录成功