- # 一、 Arouter的组件注册
	- ## 1. 自动注册插件
	  collapsed:: true
		- 在看ARouter源码的过程中看到，在初始化方法 init（），有个 boolean 变量 registerByPlugin, 表示是否用了插件注册组件。那么这个插件干了什么，为什么要用插件或者不用插件有啥问题吗？
		- LogisticsCenter
		  collapsed:: true
			- ```
			  init（）{
			           ...
			         //load by plugin first
			          loadRouterMap();
			          if (registerByPlugin) {
			              logger.info(TAG, "Load router map by arouter-auto-register plugin.");
			          } else {
			              ...
			              // These class was generated by arouter-compiler.
			              routerMap = ClassUtils.getFileNameByPackageName(mContext, 
			              ...
			          }
			      }
			  ```
		- build.gradle
			- ```
			  apply plugin: 'com.alibaba.arouter'
			  
			  buildscript {
			     ...
			      dependencies {
			          classpath "com.alibaba:arouter-register:1.0.2"
			      }
			  }
			  ```
	- ## 2. arouter的工作流程：
	  collapsed:: true
		- 流程
		  collapsed:: true
			- ![image.png](../assets/image_1684413203491_0.png)
		- 回顾ARouter的流程，分三个步骤
		- （1）利用APT 编译期生成构建映射表的类和方法
		  collapsed:: true
			- ```
			  public class ARouter$$Root$$MainBusiness implements IRouteRoot {
			      @Override
			      public void loadInto(Map<String, Class<? extends IRouteGroup>> routes) {
			          routes.put("detail", ARouter$$Group$$detail.class);
			          routes.put("home", ARouter$$Group$$home.class);
			      }
			  } 
			  
			  public class ARouter$$Group$$detail implements IRouteGroup {
			      @Override
			      public void loadInto(Map<String, RouteMeta> atlas) {
			          atlas.put("/detail/first", RouteMeta.build(RouteType.ACTIVITY, DetailActivity.class, "/detail/first", "detail", null, -1, -2147483648));
			          ...
			      }
			  }
			  ```
			- ARouter$Root$xxx ： 收集当前模块所有的Group信息，loadInto（）方法 参数传入一个map，把所有ARouter$Group$xxx 放进这个map；
			- ARouter$Group$xxx：用于收集相同group的所有组件，loadInto（）方法参数传入一个map，把所有RouteMeta（保存注解的信息，class、group、path、参数等） 放进这个map；
		- (2)加载ARouter$Root$xxx类，收集一个module的所有的group映射表
		  collapsed:: true
			- 初始化ARout时读取每个dex文件，遍历com.alibaba.android.arouter.routes目录下的文件，收集所有的 ARouter$Root$xxx 类名
			- 反射创建 ARouter$Root$xxx 对象，调用loadInfo()，把 ARouter$Group&xxx.class 装进 Map groupsIndex 保存到内存里
			-
		- (3)跳转时，根据path加载对应的ARouter$Group$xxx.class类，构建一个group的映射表，然后根据path从映射表里找到目标组件，执行跳转
			- 调用 navigation( path)，根据 groupName 从 groupsIndex 里取出 ARouter$Group$xxx.class，反射创建对象 ，调用loadInfo() , 把这个组的 RouteMate 装进 Map routes，完成group的映射表的构建加载。
			- 根据path 从 routers 取出 RouteMate(保存注解的信息class、group、path、参数等) ，获取 Activity.class 构建 Intent ，startActivity() 跳转
	-